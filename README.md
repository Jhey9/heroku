# Getting started with the automatic challenge
The automation challenge SQA. It was developed with learning from the John Ferguson Smart course and the template was used.

## The starter project
The best place to start is to clone or download the starter project on Github ([https://github.com/Jhey9/heroku.git](https://github.com/Jhey9/heroku)). This project implemented using Screenplay.

### The project directory structure
The project has build scripts for both Maven and Gradle, and follows the standard directory structure used in most Serenity projects:
```Gherkin
src
  + main
  + test
    + java                        Test runners and supporting code
    + resources
      + features                  Feature files
     + play                    Feature file subdirectories 
             play_whit_alerts.feature
```

Serenity 2.2.13 introduced integration with WebdriverManager to download webdriver binaries.

Screenplay classes emphasise reusable components and a very readable declarative style, whereas Lean Page Objects and Action Classes (that you can see further down) opt for a more imperative style.

The `Navigate` class is responsible for opening the pages and browsing:
```java
public class Navigate {
    public static Performable toJavascriptAlerts() {
        return Task.where("{0} go to alerts",
                Open.url("https://the-internet.herokuapp.com/javascript_alerts")

        );
    }
}
```

The `Gamble` class does the actual play:
```java
public class Gamble {
    public static Performable whitJSConfirm() {
        return Task.where("{0} accept JS Confirm",
                Click.on(Button.withText("Click for JS Confirm")
                ),
                AlertAction.accept()
        );
    }
}
```

In Screenplay, we keep track of locators in light weight page or component objects, like this one:
```java
class IframeUserInterface {
    static Target CONTENT_BODY = Target.the("Content body")
            .locatedBy("#tinymce");
}
```
## Simplified WebDriver configuration and other Serenity extras
The sample projects both use some Serenity features which make configuring the tests easier. In particular, Serenity uses the `serenity.conf` file in the `src/test/resources` directory to configure test execution options.
### Webdriver configuration
The WebDriver configuration is managed entirely from this file, as illustrated below:
```java 
webdriver {
    driver = chrome
    #driver = firefox
    #driver = edge
}
headless.mode = true

chrome.switches="""--start-maximized;--test-type;--no-sandbox;--ignore-certificate-errors;
                   --disable-popup-blocking;--disable-default-apps;--disable-extensions-file-access-check;
                   --incognito;--disable-infobars,--disable-gpu"""

```
Serenity uses WebDriverManager to download the WebDriver binaries automatically before the tests are executed.

## Executing the tests
The best option to run the test whit chrome `mvn clean verify -Ddriver=chrome -DCUCUMBER_PUBLISH_TOKEN=7aadb9f2-903f-4501-902b-2df4b0a38dee -DSerenity:aggregate` or whit edge `mvn clean verify -Ddriver=edge -DCUCUMBER_PUBLISH_TOKEN=7aadb9f2-903f-4501-902b-2df4b0a38dee -DSerenity:aggregate` from the command line.
or `gradle test` but ejecutar con 'Gradle' right now it is not recommended.

Modifying the properties of the 'Serenity.conf' file to change the browser where the test will be executed
```
webdriver {
    driver = chrome
    #driver = firefox
    #driver = edge
    autodownload = true
}
```

Or you can either just run the `CucumberTestSuite` test runner class. 


By default, the tests will run using Chrome. You can run them in Firefox, Egde

-DCUCUMBER_PUBLISH_TOKEN=7aadb9f2-903f-4501-902b-2df4b0a38dee: Running with Cucumber publish generates an online report.

Ddriver=chrome: Type of browser where the test will be executed.

-DSerenity:aggregate: Generate report in sernity bdd

Important: Run test with maven. Gradle generates errors in some libraries not yet solved by them.

```json
$ mvn clean verify -Ddriver=chrome -DCUCUMBER_PUBLISH_TOKEN=7aadb9f2-903f-4501-902b-2df4b0a38dee -DSerenity:aggregate

```
![](D:\Automatizacion 2022\Finished projects\Curso Ferguson SERENITY DOJO\heroku\src\test\resources\Run.png)
Or
```json
$ gradle clean test -Pdriver=firefox
```
The test results will be recorded in the `target/site/serenity` directory.

## Generating the reports
Since the Serenity reports contain aggregate information about all of the tests, they are not generated after each individual test (as this would be extremenly inefficient). Rather, The Full Serenity reports are generated by the `serenity-maven-plugin`. You can trigger this by running `mvn serenity:aggregate` from the command line or from your IDE.

They reports are also integrated into the Maven build process: the following code in the `pom.xml` file causes the reports to be generated automatically once all the tests have completed when you run `mvn verify`?

```
             <plugin>
                <groupId>net.serenity-bdd.maven.plugins</groupId>
                <artifactId>serenity-maven-plugin</artifactId>
                <version>${serenity.maven.version}</version>
                <configuration>
                    <tags>${tags}</tags>
                </configuration>
                <executions>
                    <execution>
                        <id>serenity-reports</id>
                        <phase>post-integration-test</phase>
                        <goals>
                            <goal>aggregate</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>
```

## Generating the reports in Cucumber.io

Cucumber.io generates the following online report 'https://reports.cucumber.io/report-collections/795ee5c6-d4c9-4dde-a96d-87f00a6dcd68'

## Run all tests with maven even if they fail
```pom.xml
    <plugin>
           <groupId>org.apache.maven.plugins</groupId>
           <artifactId>maven-surefire-plugin</artifactId>
           <configuration>
               <testFailureIgnore>true</testFailureIgnore>
           </configuration>
    </plugin>
```


## Want to learn more?
For more information about Serenity BDD, you can read the [**Serenity BDD Book**](https://serenity-bdd.github.io/theserenitybook/latest/index.html), the official online Serenity documentation source. Other sources include:
* **[Learn Serenity BDD Online](https://expansion.serenity-dojo.com/)** with online courses from the Serenity Dojo Training Library
* **[Byte-sized Serenity BDD](https://www.youtube.com/channel/UCav6-dPEUiLbnu-rgpy7_bw/featured)** - tips and tricks about Serenity BDD
* For regular posts on agile test automation best practices, join the **[Agile Test Automation Secrets](https://www.linkedin.com/groups/8961597/)** groups on [LinkedIn](https://www.linkedin.com/groups/8961597/) and [Facebook](https://www.facebook.com/groups/agiletestautomation/)
* [**Serenity BDD Blog**](https://johnfergusonsmart.com/category/serenity-bdd/) - regular articles about Serenity BDD


## Thanks to John Ferguson Smart